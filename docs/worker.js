!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./src/js/worker.js")}({"./src/js/classes/ComputeShapeOutside.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,r=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(i=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{!i&&u.return&&u.return()}finally{if(r)throw s}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=u(n("./src/js/classes/PointList.js")),a=u(n("./src/js/classes/Polygon.js"));function u(t){return t&&t.__esModule?t:{default:t}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=e.width,this.height=e.height,this.imageData=e.data,(n=n||{}).useAlpha=n.useAlpha||!1,n.threshold=n.threshold||250,n.padding=n.padding||20,this.options=n,this.wPadding=n.padding+1,this.wWidth=this.width+2*this.wPadding,this.wHeight=this.height+2*this.wPadding}return r(t,[{key:"run",value:function(){var t=this._computeRawMask(),e=this._computePaddedMask(t),n=this._computeRawContour(e),i=this._computePolygon(n);return{options:this.options,width:this.width,height:this.height,pixelData:new ImageData(this.imageData,this.width,this.height),rawMaskData:this._getImageDataFromGrid(t),paddedMaskData:this._getImageDataFromGrid(e),rawContour:n,polygon:i,shapeOutsidePolygon:this._getCSS(i)}}},{key:"_getNewGrid",value:function(){for(var t=new Array(this.wWidth),e=0;e<this.wWidth;e++)t[e]=new Uint8Array(this.wHeight);return t}},{key:"_getImageDataFromGrid",value:function(t){for(var e=new Uint8ClampedArray(this.wWidth*this.wHeight*4),n=0,i=0;i<this.wHeight;i++)for(var r=0;r<this.wWidth;r++){var s=1===t[r][i]?0:255,a=t[r][i]>1?0:s;e[n++]=s,e[n++]=a,e[n++]=a,e[n++]=255}return new ImageData(e,this.wWidth,this.wHeight)}},{key:"_computeRawMask",value:function(){for(var t=this.options,e=t.useAlpha,n=t.threshold,i=this.imageData,r=this.wPadding,s=this._getNewGrid(),a=0,u=r,o=r,h=0;h<i.length;h+=4){if(e)s[u][o]=i[h+3]<n?0:1;else{var c=.2126*i[h]+.7152*i[h+1]+.0722*i[h+2];s[u][o]=c>n?0:1}u++,++a===this.width&&(a=0,u=r,o++)}return s}},{key:"_computePaddedMask",value:function(t){for(var e=this.options.padding,n=this._getNewGrid(),i=new s.default,r=this.wWidth-1,a=this.wHeight-1,u=function(t,e,n){return t[e-1][n]&&t[e+1][n]&&t[e][n-1]&&t[e][n+1]},o=this._getNewGrid(),h=0;h<=r;h++)for(var c=0;c<=a;c++)t[h][c]?(n[h][c]=1,u(t,h,c)||(i.push(h,c),o[h][c]=1)):n[h][c]=0;for(var l=function(t,e){return!u(n,t,e)},f=function(t,e){return!o[t][e]&&(o[t][e]=1,!0)},d=function(t){var e=new s.default;i.forEach(function(t,n){e.pushIf(t-1,n,f),e.pushIf(t+1,n,f),e.pushIf(t,n-1,f),e.pushIf(t,n+1,f)}),i=e.filter(l)},p=0;p<e;p++)d();return i.forEach(function(t,e){n[t][e]=2}),n}},{key:"_computeRawContour",value:function(t){for(var e=new a.default,n=this.wWidth-1,r=this.wHeight-1,s=0;s<=r;s++){for(var u=n;u>=0&&2!==t[u][s];)u--;u>=0&&e.push(u,s)}for(var o=e.getFirst(),h=i(o,2),c=h[0],l=h[1],f=e.getLast(),d=i(f,2),p=d[0],y=d[1],g=y;g>=0;g--){for(var v=0;v<=n&&2!==t[v][g];)v++;v<=n&&(g===y&&v===p||g===l&&v===c||e.push(v,g))}return e}},{key:"_computePolygon",value:function(t){var e=this.options.padding/5;return t.simplify(e)}},{key:"_getCSS",value:function(t){switch(this.options.position){case"left":return this._clipAndGetCSS(t,!0,!1,!0,!1);case"right":return this._clipAndGetCSS(t,!1,!0,!0,!1);default:return this._clipAndGetCSS(t,!1,!1,!0,!0)}}},{key:"_clipAndGetCSS",value:function(t,e,n,r,s){var a=this.wPadding,u=t,o=this.wWidth,h=this.wHeight;if(e&&(u=u.clip(a,0,a,h,function(t){return t>=a}).translate(-a,0),o-=a),n){var c=o-1-a;u=u.clip(c,0,c,h,function(t){return t<=c}),o-=a}if(r&&(u=u.clip(0,a,o,a,function(t,e){return e>=a}).translate(0,-a),h-=a),s){var l=h-1-a;u=u.clip(0,l,o,l,function(t,e){return e<=l}),h-=a}for(var f=[],d=100/(o-1),p=100/(h-1),y=0;y<u.length;y++){var g=u.getAt(y),v=i(g,2),w=v[0],_=v[1],x=(w*d).toFixed(0)+"%",b=(_*p).toFixed(0)+"%";f.push(x+" "+b)}return f.join(", ")}}]),t}();e.default=o},"./src/js/classes/Line.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e,n,i,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x1=e,this.y1=n,this.x2=i,this.y2=r,this.dx=this.x2-this.x1,this.dy=this.y2-this.y1,this.squareLength=this.dx*this.dx+this.dy*this.dy,this.dot=this.x2*this.y1-this.x1*this.y2}return i(t,[{key:"squareDistanceFrom",value:function(t,e){var n=this.dy*t-this.dx*e+this.dot;return n*n/this.squareLength}},{key:"intersectWith",value:function(t){var e=this.dot*t.dx-t.dot*this.dx,n=this.dot*t.dy-t.dot*this.dy,i=this.dx*t.dy-t.dx*this.dy;return[Math.round(e/i),Math.round(n/i)]}}]),t}();e.default=r},"./src/js/classes/PointList.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();var r=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=new Uint16Array(e||64),this.y=new Uint16Array(e||64),this.length=0}return i(t,[{key:"_extendStorage",value:function(t){var e=new Uint16Array(t),n=new Uint16Array(t);e.set(this.x,0),n.set(this.y,0),this.x=e,this.y=n}},{key:"push",value:function(t,e){if(this.length===this.x.length){var n=this.length<65536?this.length:65536;this._extendStorage(this.length+n)}this.x[this.length]=t,this.y[this.length]=e,this.length++}},{key:"pushIf",value:function(t,e,n){n(t,e)&&this.push(t,e)}},{key:"getAt",value:function(t){return[this.x[t],this.y[t]]}},{key:"getFirst",value:function(){return this.getAt(0)}},{key:"getLast",value:function(){return this.getAt(this.length-1)}},{key:"concat",value:function(t){var e=this.length+t.length;return this.x.length<=e&&this._extendStorage(e),this.x.set(t.x.slice(0,t.length),this.length),this.y.set(t.y.slice(0,t.length),this.length),this.length=e,this}},{key:"translate",value:function(t,e){for(var n=0;n<this.length;n++)this.x[n]+=t,this.y[n]+=e;return this}},{key:"forEach",value:function(t,e,n){e=e||0,n=n||this.length;for(var i=e;i<n;i++){if(t(this.x[i],this.y[i],i))return}}},{key:"slice",value:function(t,e){var n=e-t,i=new this.constructor(n);return i.x.set(this.x.slice(t,e)),i.y.set(this.y.slice(t,e)),i.length=n,i}},{key:"filter",value:function(t){var e=new this.constructor;return this.forEach(function(n,i){e.pushIf(n,i,t)}),e}}]),t}();e.default=r},"./src/js/classes/Polygon.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=a(n("./src/js/classes/PointList.js")),s=a(n("./src/js/classes/Line.js"));function a(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.default),i(e,[{key:"clip",value:function(t,n,i,r,a){for(var u=new s.default(t,n,i,r),o=new e,h=this.length-1,c=this.x[h],l=this.y[h],f=a(c,l),d=0;d<=h;d++){var p=this.x[d],y=this.y[d],g=a(p,y);if(g^f){var v=u.intersectWith(new s.default(c,l,p,y));o.push(v[0],v[1])}g&&o.push(p,y),c=p,l=y,f=g}return o}},{key:"simplify",value:function(t){var n=t*t,i=this._douglasPeucker(n),r=new e,a=i.length-1,u=i.x[a],o=i.y[a];return r.push(u,o),i.forEach(function(t,e){new s.default(u,o,t,e).squareLength>=n&&(u=t,o=e,r.push(u,o))}),r}},{key:"_douglasPeucker",value:function(t){if(this.length<=3)return this;for(var n=this.length-1,i=0,r=0,a=new s.default(this.x[0],this.y[0],this.x[n],this.y[n]),u=1;u<n;u++){var o=a.squareDistanceFrom(this.x[u],this.y[u]);o>i&&(i=o,r=u)}if(i<=t){var h=new e(2);return h.push(this.x[0],this.y[0]),h.push(this.x[n],this.y[n]),h}var c=new e;return c.concat(this.slice(0,r)._douglasPeucker(t)),c.concat(this.slice(r,this.length)._douglasPeucker(t)),c}}]),e}();e.default=u},"./src/js/worker.js":function(t,e,n){"use strict";var i,r=n("./src/js/classes/ComputeShapeOutside.js"),s=(i=r)&&i.__esModule?i:{default:i};self.addEventListener("message",function(t){var e=t.data,n=e.imageData,i=e.options,r=new s.default(n,i).run();self.postMessage(r)})}});
//# sourceMappingURL=worker.js.map